using MultiPrecision;
using System;

namespace GammaPade {
    internal static class FiniteDifference<N> where N : struct, IConstant {
        public struct DoubleN : IConstant {
            public int Value => checked(default(N).Value * 2);
        }

        public static readonly int sample_points;
        public static readonly MultiPrecision<N>[][] table;

        public static readonly Fraction[][] frac_table = {
            new Fraction[]{"0", "16/17",    "-20/51",   "560/2907", "-91/969",  "208/4845", "-52/2907", "1040/156009",  "-65/29716",    "208/334305",   "-28/185725",   "112/3677355",  "-1/200583",    "16/25206597",  "-4/67863915",  "16/4508102925",    "-1/9617286240"},
            new Fraction[]{"-822968714749/259718659200",    "32/17",    "-20/51",   "1120/8721",    "-91/1938", "416/24225",    "-52/8721", "2080/1092063", "-65/118864",   "416/3008745",  "-28/928625",   "224/40450905", "-1/1203498",   "32/327685761", "-4/475047405", "32/67621543875",   "-1/76938289920"},
            new Fraction[]{"0", "-88240010863261/26491303238400",   "200828049626461/62916845191200",   "-221677686434461/125833690382400", "228975059317261/251667380764800",  "-232352700480157/532373305464000", "234187468519261/1224458602567200", "-235293775778461/3116803715625600",    "236011811739961/8905153473216000", "-26278232759029/3215749865328000", "47371244406137/21706311590964000", "-1959642614341/3946602107448000",  "237314914040461/2517932144551824000",  "-1405142765269/96843544021224000", "237591490855261/136597818841936452000",    "-47538041500601/312223585924426176000",    "59442749961409/6868918890337375872000",    "-48409924397/202027026186393408000"},
            new Fraction[]{"4482620101276978337/259614771736320000",    "-88240010863261/6622825809600",    "200828049626461/31458422595600",   "-221677686434461/94375267786800",  "228975059317261/251667380764800",  "-232352700480157/665466631830000", "234187468519261/1836687903850800", "-235293775778461/5454406502344800",    "236011811739961/17810306946432000",    "-26278232759029/7235437196988000", "47371244406137/54265778977410000", "-1959642614341/10853155795482000", "237314914040461/7553796433655472000",  "-1405142765269/314741518068978000",    "237591490855261/478092365946777582000",    "-47538041500601/1170838447216598160000",   "59442749961409/27475675561349503488000",   "-48409924397/858614861292171984000"},
            new Fraction[]{"0", "7483000866014408633/493268066299008000",   "-370942493681086837561/19730722651960320000",  "533769982601337439561/38844860221046880000",   "-46111429662690393097/5843329400772864000",    "27451029776505269663/6782435911611360000", "-649120280431557560761/345591195988566528000", "13468542044076468889/17142420435940800000",    "-83381054373197911367/283629138121929600000",  "5743029356575209733/58907590225323840000", "-675441939923342491321/23824847602242086400000",   "5603668177367253841/785137023255705120000",    "-680026660101386391061/444163230298941753600000",  "4032970720559115169/14710534336823925600000",  "-13934687845151639689/349690416235357317120000",   "683791035145871770441/151459661531939137977600000",    "-1258461360712189969/3365770256265314177280000",   "10729404232993469/533040538322561068800000",   "-194896526142477319/368771349816895292467200000"},
            new Fraction[]{"-15070274400444902431609/140191976737612800000",    "7483000866014408633/82211344383168000",    "-370942493681086837561/6576907550653440000",   "533769982601337439561/19422430110523440000",   "-46111429662690393097/3895552933848576000",    "27451029776505269663/5652029926342800000", "-649120280431557560761/345591195988566528000", "13468542044076468889/19999490508597600000",    "-83381054373197911367/378172184162572800000",  "5743029356575209733/88361385337985760000", "-675441939923342491321/39708079337070144000000",   "5603668177367253841/1439417875968792720000",   "-680026660101386391061/888326460597883507200000",  "4032970720559115169/31872824396451838800000",  "-13934687845151639689/815944304549167073280000",   "683791035145871770441/378649153829847844944000000",    "-1258461360712189969/8975387350040837806080000",   "10729404232993469/1510281525247256361600000",  "-194896526142477319/1106314049450685877401600000"},
            new Fraction[]{"0", "-34787323375486646095697/447671858489856000000",   "1934962493274339162859399/17757650386764288000000",    "-18302955740132070159230011/195334154254407168000000", "138440351532698289511558741/2246342773925682432000000",    "-617696654491251280783813/17970742191405459456000",    "9104229937613061762268687/534843517601352960000000",   "-1733108995583204516218817/229218650400579840000000",  "43457167518520707897842329/14440774975236529920000000",    "-3270568467553467168042979/3063194691716839680000000", "714504382094164025588467/2131983505434920417280000",   "-1115956352520942577019/12107488900066560000000",  "2627295700869720453247289/119730957732758211840000000",    "-41462211795405159772589/9311283272539100160000000",   "1866359661694446060732167/2472810800521455313920000000",   "-14390950486163397292007/138477404829201497579520000", "676329738614223036224153/60583864612775655191040000000",   "-18762256603144852530241/21382540451567878302720000000",   "187500473279253300469/4178197559501769323520000000",   "-21437090185554626503/19131746719823891112960000000"},
            new Fraction[]{"49326019088009378062697/70250045486100480000",  "-34787323375486646095697/55958982311232000000",    "1934962493274339162859399/4439412596691072000000", "-18302955740132070159230011/73250307845402688000000",  "138440351532698289511558741/1123171386962841216000000",    "-617696654491251280783813/11231713869628412160000",    "9104229937613061762268687/401132638201014720000000",   "-1733108995583204516218817/200566319100507360000000",  "43457167518520707897842329/14440774975236529920000000",    "-3270568467553467168042979/3446094028181444640000000", "714504382094164025588467/2664979381793650521600000",   "-1115956352520942577019/16647797237591520000000",  "2627295700869720453247289/179596436599137317760000000",    "-41462211795405159772589/15130835317876037760000000",  "1866359661694446060732167/4327418900912546799360000000",   "-14390950486163397292007/259645134054752807961600000", "676329738614223036224153/121167729225551310382080000000",  "-18762256603144852530241/45437898459581741393280000000",   "187500473279253300469/9400944508878980977920000000",   "-21437090185554626503/45437898459581741393280000000"},
            new Fraction[]{"0", "5640334347722843414899651/13318237790073216000000",    "-373573118337332084947286869/586002462763221504000000",    "227001625098738106787063123/374390462320947072000000", "-15922288958464645465825858523/35941484382810918912000000",    "151527255246338763214721533/561585693481420608000000", "-1609160363298630045266106521/11231713869628412160000000", "34913762518242847094978429/515741963401304640000000",  "-5788048178788029428273505287/202170849653311418880000000",    "7934457195506603419148889091/732869329993253893440000000", "-194258875272856426024672297/53299587635873010432000000",  "203669126245957386022701713/187759910990007195840000000",  "-859418946582719489098727087/3038689134183104962560000000",    "11444209438638740164713509/179242202996377678080000000",   "-30394823784322235073318181/2472810800521455313920000000", "11982053407932028819398061/6058386461277565519104000000",  "-94042496024981595356732359/363503187676653931146240000000",   "4870879681017859172777/184332245272136881920000000",   "-718490135156378033955641/363503187676653931146240000000", "460543182147008525611/4782936679955972778240000000",   "-1333135651027280488181/581605100282646289833984000000"},
            new Fraction[]{"-39319144964629653350909359/8430005458332057600000",    "5640334347722843414899651/1331823779007321600000", "-373573118337332084947286869/117200492552644300800000",    "227001625098738106787063123/112317138696284121600000", "-15922288958464645465825858523/14376593753124367564800000",    "151527255246338763214721533/280792846740710304000000", "-1609160363298630045266106521/6739028321777047296000000",  "34913762518242847094978429/361019374380913248000000",  "-5788048178788029428273505287/161736679722649135104000000",    "7934457195506603419148889091/659582396993928504096000000", "-194258875272856426024672297/53299587635873010432000000",  "203669126245957386022701713/206535902089007915424000000",  "-859418946582719489098727087/3646426961019725955072000000",    "11444209438638740164713509/233014863895290981504000000",   "-30394823784322235073318181/3461935120730037439488000000", "11982053407932028819398061/9087579691916348278656000000",  "-94042496024981595356732359/581605100282646289833984000000",   "4870879681017859172777/313364816962632699264000000",   "-718490135156378033955641/654305737817977076063232000000", "460543182147008525611/9087579691916348278656000000",   "-1333135651027280488181/1163210200565292579667968000000"},
            new Fraction[]{"0", "-1221523057687798599993135859/511420331138811494400000",   "22125296051241790477195132571/5881333808096332185600000",  "-810362824852085678418099553709/211728017091467958681600000",  "59261319282485753129667023533/19604446026987773952000000", "-77911648659363436657406030041/39208892053975547904000000",    "717623660990306365913764673/635184051274403876044800", "-50093534310871636877246898049/88220007121444982784000000",    "162997521576338066104026072781/639595051630476125184000000",   "-786038097176963396550210413329/7675140619565713502208000000", "1459009215600197462261998496857/39654893201089519761408000000",    "-2127182057506393478695130197/180814560050564923392000000",    "9495593795612147844953078037817/2855152310478445422821376000000",  "-1031014597405186295278006457/1251436471829255061504000000",   "9347090920851657556794793501/52873190934786026348544000000",   "-5436191599776176438895404773/167950135910496789577728000000", "196554431777086037762440321/39654893201089519761408000000",    "-11523849099000869295049907/18661126212277421064192000000",    "986523141382532993884991/16408921324588766797824000000",   "-28652411592467823911519/6678718854920340170342400000",    "63301615125874352692579/317239145608716158091264000000",   "-25919014478991201945227/5710304620956890845642752000000"},
            new Fraction[]{"17500209220188673501836002887/563277637443096576000000",    "-1221523057687798599993135859/42618360928234291200000",    "22125296051241790477195132571/980222301349388697600000",   "-810362824852085678418099553709/52932004272866989670400000",   "59261319282485753129667023533/6534815342329257984000000",  "-77911648659363436657406030041/16337038355823144960000000",    "717623660990306365913764673/317592025637201938022400", "-50093534310871636877246898049/51461670820842906624000000",    "162997521576338066104026072781/426396701086984083456000000",   "-786038097176963396550210413329/5756355464674285126656000000", "1459009215600197462261998496857/33045744334241266467840000000",    "-2127182057506393478695130197/165746680046351179776000000",    "9495593795612147844953078037817/2855152310478445422821376000000",  "-1031014597405186295278006457/1355722844481692983296000000",   "9347090920851657556794793501/61685389423917030739968000000",   "-5436191599776176438895404773/209937669888120986972160000000", "196554431777086037762440321/52873190934786026348544000000",    "-11523849099000869295049907/26436595467393013174272000000",    "986523141382532993884991/24613381986883150196736000000",   "-28652411592467823911519/10574638186957205269708800000",   "63301615125874352692579/528731909347860263485440000000",   "-25919014478991201945227/9993033086674558979874816000000"},
            new Fraction[]{"0", "489012722256240423768612322943/35627310568275858432000000",    "-3632509368015649703017289364571/162867705454975352832000000", "519197034432474389852538835609/21812639123434199040000000",    "-82817074937790971240846051563/4154788404463656960000000", "85201801491953781091885221349/6107538954561575731200000",  "-432792395606026698402438865282621/51303327218317236142080000000", "4978005001281341511202396887457/1106991435514285601280000000", "-33120501191437153375246991378411/15497880097199998417920000000",  "31229153993900255555942993709257/34316734500942853639680000000",   "-8721034100692194784851391782331/25100240092118201519308800000",   "4653961482888193540365567242947/39219125143934689873920000000",    "-6993393882142913907714812177863/193788618358265526435840000000",  "1435002100521925278215685474293/147825933234830754140160000000",   "-10056003640412643152354234435521/4392542016120685265879040000000",    "53956021767563716766369313629/115304227923167988229324800000", "-659430636839980093893199601/8074525764927730268160000000",    "13760428647535237682819081/1153503680703961466880000000",  "-890254715750618265819224597/627506002302955037982720000000",  "146657082539826160375771/1111473182216772587520000000",    "-2767799498569867739536729/307477941128447968611532800000",    "329921966405016851924309/823601628022628487352320000000",  "-268280560166005020647177/30747794112844796861153280000000"},
            new Fraction[]{"-7222646507971226987499004753321/35051962695744695500800000",   "489012722256240423768612322943/2544807897733989888000000", "-3632509368015649703017289364571/23266815064996478976000000",  "519197034432474389852538835609/4674136955021614080000000", "-82817074937790971240846051563/1187082401275330560000000", "85201801491953781091885221349/2181263912343419904000000",  "-432792395606026698402438865282621/21987140236421672632320000000", "4978005001281341511202396887457/553495717757142800640000000",  "-33120501191437153375246991378411/8855931484114284810240000000",   "31229153993900255555942993709257/22060757893463263054080000000",   "-8721034100692194784851391782331/17928742922941572513792000000",   "4653961482888193540365567242947/30815026898805827758080000000",    "-6993393882142913907714812177863/166104530021370451230720000000",  "1435002100521925278215685474293/137266938003771414558720000000",   "-10056003640412643152354234435521/4392542016120685265879040000000",    "53956021767563716766369313629/123540244203394273102848000000", "-659430636839980093893199601/9228029445631691735040000000",    "13760428647535237682819081/1400683040854810352640000000",  "-890254715750618265819224597/806793431532370763120640000000",  "146657082539826160375771/1508427890151334225920000000",    "-2767799498569867739536729/439254201612068526587904000000",    "329921966405016851924309/1235402442033942731028480000000", "-268280560166005020647177/48317962177327537924669440000000"},
            new Fraction[]{"0", "-513592364290659431947301503532957/6449561136017023972147200000",  "194029324970995053517817532493607/1465809349094778175488000000",   "-88552941575783136653976370657777/604937191689908453376000000",    "392785135430518322037066650315357/3062494532930161545216000000",   "-6480276281719711588788438983113343/68599877537635618612838400000",    "11100631506367885942169057314811041/184203374869577124052992000000",   "-3211462544826054770785264777413727/94733164218639663798681600000",    "6825998182917906060913515093728197/401505793661031387584256000000",    "-58216431623503672858055139049713511/7613739494609187794190336000000", "99840855223811169322281387948463937/32304008998556125355350425600000", "-2534543654223788621425624648821983/2259021608290638136737792000000",  "440558801804817556570512553019491/1207949054433188448116736000000",    "-385537095636172436740132445425411/3649188751854107759345664000000",   "91791576764417352655586553578293/3388532412435957205106688000000", "-2141287858033391780048917985081/351403361289654821270323200000",  "954644265075360938866519244593/803011587322062775168512000000",    "-342341607715624718816611459429/1727487112222252692799488000000",  "120376734782638035650135567/4350708282633821596680192000", "-34053768322744428885473610121/10819524544970951075954688000000",  "720019668793549846020920587/2569637079430600880539238400000",  "-657246960999708258644997547/35893343331729028172611584000000",    "240870130981930611452518849/308356449531672105664708608000000",    "-4814093131214104648496017/294949647378121144548851712000000"},
            new Fraction[]{"11384296563991214917557280860107/8397866062522166630400000",    "-513592364290659431947301503532957/403097571001063998259200000",   "194029324970995053517817532493607/183226168636847271936000000",    "-88552941575783136653976370657777/113425723441857835008000000",    "392785135430518322037066650315357/765623633232540386304000000",    "-6480276281719711588788438983113343/21437461730511130816512000000",    "11100631506367885942169057314811041/69076265576091421519872000000",    "-3211462544826054770785264777413727/41445759345654852911923200000",    "6825998182917906060913515093728197/200752896830515693792128000000",    "-58216431623503672858055139049713511/4282728465717668134232064000000", "99840855223811169322281387948463937/20190005624097578347094016000000", "-2534543654223788621425624648821983/1553077355699813719007232000000",  "440558801804817556570512553019491/905961790824891336087552000000", "-385537095636172436740132445425411/2964965860881462554468352000000",   "91791576764417352655586553578293/2964965860881462554468352000000", "-2141287858033391780048917985081/329440651209051394940928000000",  "954644265075360938866519244593/803011587322062775168512000000",    "-342341607715624718816611459429/1835455056736143486099456000000",  "120376734782638035650135567/4894546817963049296265216000", "-34053768322744428885473610121/12848185397153004402696192000000",  "720019668793549846020920587/3212046349288251100674048000000",  "-657246960999708258644997547/47110013122894349476552704000000",    "240870130981930611452518849/423990118106049145288974336000000",    "-4814093131214104648496017/423990118106049145288974336000000"},
            new Fraction[]{"0", "21146194957799522026419227886103/45599272737676922880000000",  "-12088193525494151962559321101768531/15412554185334799933440000000",   "5621192488018448671286078094955253/6305135803091509063680000000",  "-464083215445573693834320394845427/573194163917409914880000000",   "13995115026417180846859444081121/22504484712572770811904000",  "-151886533706188009681706171373306961/365697876579307525693440000000", "859328025759480766312689201490291/3505452743957493288960000000",   "-37548117326792336782019750141422019/290682927537398289653760000000",  "847062274996145794721244045501313831/13855886212615985140162560000000",    "-3466684912237885606515533702752009/133016507641113457345560576000",   "37833973146767682280228903673590943/3778878057986177765498880000000",  "-88040102813371416454171261516291/25444394187623722967040000000",  "791069906254774103612695831325411/737887431441087966044160000000", "-811221272363445961017288717157/2737986758594018426880000000", "119608808669279419670478805699/1648964970757604843126784000",  "-14729325673697565636784128904003/944719514496544441374720000000", "379019782689826504497412995157/130306139930557853982720000000",    "-8174006788914727901595348001/17617147123478684221440000000",  "12337637631046916167327783387/198888318841377777131520000000", "-449743256471399410793301583/66508253820556728672780288000",   "113015566187902077344587057/195766053239472317521920000000",   "-820832895489725986381354387/22673268347917066592993280000000",    "8040821708261178467056123/5421868517980168098324480000000",    "-3713250997679022510690251/124702975913543866261463040000000"},
            new Fraction[]{"-13557958314285976100325732376063/1535609794289767612416000",   "21146194957799522026419227886103/2533292929870940160000000",   "-12088193525494151962559321101768531/1712506020592755548160000000",    "5621192488018448671286078094955253/1050855967181918177280000000",  "-464083215445573693834320394845427/127376480870535536640000000",   "13995115026417180846859444081121/6251245753492436336640000",   "-151886533706188009681706171373306961/121899292193102508564480000000", "859328025759480766312689201490291/1363231622650136279040000000",   "-37548117326792336782019750141422019/129192412238843684290560000000",  "847062274996145794721244045501313831/6927943106307992570081280000000", "-3466684912237885606515533702752009/73898059800618587414200320000",    "37833973146767682280228903673590943/2309314368769330856693760000000",  "-88040102813371416454171261516291/16962929458415815311360000000",  "791069906254774103612695831325411/532918700485230197698560000000", "-811221272363445961017288717157/2129545256684236554240000000", "119608808669279419670478805699/1374137475631337369272320000",  "-14729325673697565636784128904003/839750679552483947888640000000", "379019782689826504497412995157/123066909934415750983680000000",    "-8174006788914727901595348001/17617147123478684221440000000",  "12337637631046916167327783387/209937669888120986972160000000", "-449743256471399410793301583/73898059800618587414200320000",   "113015566187902077344587057/228393728779384370442240000000",   "-820832895489725986381354387/27711772425231970280325120000000",    "8040821708261178467056123/6927943106307992570081280000000",    "-3713250997679022510690251/166270634551391821681950720000000"},
            new Fraction[]{"0", "-24829255894835993207468377429316569/9193453373708477153280000000",    "383125934298298793077779528815806771/82741080363376294379520000000",   "-74193254239858117214730406402345709/13790180060562715729920000000",   "2194612706309006897118561641555029387/436271151006893188546560000000", "-17455737164942690197939827110520683/4362711510068931885465600000",    "6264750252704617045252058857822352117/2254067613535614807490560000000",    "-944805386927170089989805137649878771/552016558416885258977280000000", "187094809569420500884493225940372709279/198357949991134103059169280000000",    "-5155890123508467379704668015873812853/11019886110618561281064960000000",  "415681847810164989651942285993600641/1983579499911341030591692800000", "-573727624371174454582946713488161279/6762202840606844422471680000000",    "3077033932433974097796282463908162667/99178974995567051529584640000000",   "-4499559128732548167809578182262799/440143380157841944657920000000",   "9180284172730485694345824395558663/3036091071292868924375040000000",   "-143994580893510808907539729611419/180325409082849184599244800000",    "2528678944148383317857505554201177/13524405681213688844943360000000",  "-10200906574393454945811478024477/265184425121837036175360000000", "491898840217451607979221519307/71557702017003644682240000000", "-26061854407549345227013737676063/24794743748891762882396160000000",   "1604344138039897775565407455451/11901476999468046183550156800000", "-7137590528941562286964318157/506015178548811487395840000000", "15643536608961577307633640403/13524405681213688844943360000000",   "-901930607418980336962499233/12936388042900050199511040000000",    "3814202093313611858181546917/1388505649937938721414184960000000",  "-4422240931095604296066559/83310338996276323284851097600000"},
            new Fraction[]{"395148807053813088040370606924899/6948460607646007296000000",   "-24829255894835993207468377429316569/459672668685423857664000000", "383125934298298793077779528815806771/8274108036337629437952000000",    "-74193254239858117214730406402345709/2068527009084407359488000000",    "2194612706309006897118561641555029387/87254230201378637709312000000",  "-17455737164942690197939827110520683/1090677877517232971366400000",    "6264750252704617045252058857822352117/676220284060684442247168000000", "-944805386927170089989805137649878771/193205795445909840642048000000", "187094809569420500884493225940372709279/79343179996453641223667712000000", "-5155890123508467379704668015873812853/4958948749778352576479232000000",   "415681847810164989651942285993600641/991789749955670515295846400000",  "-573727624371174454582946713488161279/3719211562333764432359424000000",    "3077033932433974097796282463908162667/59507384997340230917750784000000",   "-346119932979426782139198321712523/22007169007892097232896000000", "9180284172730485694345824395558663/2125263749905008247062528000000",   "-143994580893510808907539729611419/135244056812136888449433600000",    "2528678944148383317857505554201177/10819524544970951075954688000000",  "-600053327905497349753616354381/13259221256091851808768000000",    "491898840217451607979221519307/64401931815303280214016000000", "-26061854407549345227013737676063/23555006561447174738276352000000",   "1604344138039897775565407455451/11901476999468046183550156800000", "-7137590528941562286964318157/531315937476252061765632000000", "15643536608961577307633640403/14876846249335057729437696000000",   "-901930607418980336962499233/14876846249335057729437696000000",    "3814202093313611858181546917/1666206779925526465697021952000000",  "-4422240931095604296066559/104137923745345404106063872000000"},
            new Fraction[]{"0", "1409623370163139053088391616351170081/89833172965951405326336000000",  "-19549467786273126343560114670935543623/718665383727611242610688000000",   "1552461302852853516591237538126349389/48243741037270199156736000000",  "-80298826132333038351734764379843160179/2605162016012590754463744000000",  "153205278865100870978476107967859237/6067620022268242929254400000",    "-14352141388574888950422346384877617139/791037869569785744850944000000",   "76468235430585963634949458437144661561/6592654897664515378642944000000",   "-113151123655722224599934700986125506629/17002109999240065976500224000000",    "241107822461372044120174862409958247/69967530861070230355968000000",   "-43945424421537675712059212597743645733/27203375998784105562400358400000", "265299830454205173605231298904822169/386411590891819681284096000000",  "-1582315441047125525212862728164274769/5982223888621504695435264000000",   "19756124523232313029738867376423603/214217566303422581932032000000",   "-765271904170138978836332988621425561/26370619590658061514571776000000",   "9818956268907292702887719613975989/1196444777724300939087052800000",   "-974289769737987468967787535709/469696131210068066304000000",  "5218982604695058552477722397763/11217448780663978524672000000",    "-487977333515387971582630621938133/5317532345441337507053568000000",   "66875674520405329668937347862339/4250527499810016494125056000000", "-74614577525920699195212328681037/32304008998556125355350425600000",   "17372691255625009795621681337/61043100904301068320768000000",  "-6726286276288754321849490634793/234938247262226366220730368000000",   "222052852474619360870597365391/98316549126040381516283904000000",  "-2195058804882056694509149427/16750226888140213147218739200000",   "2249183833703693158090401971/452256125979785754974905958400000",   "-128886900809076577296452707/1391557310707033092230479872000000"},
            new Fraction[]{"-6135700254964968406148708411808967/16945019375067463680000000",    "1409623370163139053088391616351170081/4083326043906882060288000000",   "-19549467786273126343560114670935543623/65333216702510112964608000000",    "1552461302852853516591237538126349389/6578691959627754430464000000",   "-80298826132333038351734764379843160179/473665821093198318993408000000",   "1685258067516109580763237187646451607/15169050055670607323136000000",  "-14352141388574888950422346384877617139/215737600791759748595712000000",   "76468235430585963634949458437144661561/2097662921984163984113664000000",   "-113151123655722224599934700986125506629/6182585454269114900545536000000", "241107822461372044120174862409958247/28623080806801457872896000000",   "-43945424421537675712059212597743645733/12365170908538229801091072000000", "265299830454205173605231298904822169/193205795445909840642048000000",  "-1582315441047125525212862728164274769/3263031211975366197510144000000",   "19756124523232313029738867376423603/126583107361113343868928000000",   "-765271904170138978836332988621425561/16781303375873311872909312000000",   "9818956268907292702887719613975989/815757802993841549377536000000",    "-974289769737987468967787535709/341597186334594957312000000",  "306998976746768150145748376339/509884035484726296576000000",   "-487977333515387971582630621938133/4350708282633821596680192000000",   "66875674520405329668937347862339/3670910113472286972198912000000", "-74614577525920699195212328681037/29367280907778295777591296000000",   "17372691255625009795621681337/58268414499560110669824000000",  "-6726286276288754321849490634793/234938247262226366220730368000000",   "222052852474619360870597365391/102785483177224035221569536000000", "-2195058804882056694509149427/18272974787062050706056806400000",   "2249183833703693158090401971/513927415886120176107847680000000",   "-128886900809076577296452707/1644567730835584563545112576000000"},
            new Fraction[]{"0", "-368494364748615982580024489494053019/4057963770342243041280000000",   "65438384060924982511210081634369383937/411883322689737668689920000000",    "-10477646881545274376628826839705957371/54917776358631689158656000000",    "23814299351456454796742954738962731383/127683830033818677293875200000",    "-128040694677155321420532888465716357323/817176512216439534680801280000",  "394799904028690062041830380432515823161/3404902134235164727836672000000",  "-31943482184615439776561993749032813631/416926791947163027898368000000",   "23279285142077313974639513061935655149/510735320135274709175500800000",    "-8795719067346824569100578739059266293/358410750972122602930176000000",    "36853026366455805158667637028181037/3072092151189622310830080000", "-9902814561186559573284680138954548043/1857219345946453487910912000000",   "31635156443674713410591757494949587/14676302302737778999296000000",    "-622109229436345672186540475053108391/785746646361961091039232000000", "27483245101763537444109264709093847/104231697986790756974592000000",   "-10808477273340045195073345879996693/136196085369406589113466880000",  "13720499146083656752322146349686927/638419150169093386469376000000",   "-21576828496127394548241296627809/4143897120773019952742400000",   "1907518128814061848674544201494523/1702451067117582363918336000000",   "-16296885975014825799241787770409/76802303779740557770752000000",  "1785335697210643958779617383447/51073532013527470917550080000",    "-137149267596644390737921767151/27795119463144201859891200000",    "3802472818996782637735845396533/6500267710812587207688192000000",  "-40511042162404503515031540953999/715029448189384592845701120000000",  "128280790624349275328911836973/29792893674557691368570880000000",  "-1377558295832456341098288793/5720235585515076742765608960000",    "14259923321360680617878509/1617713683686390481551360000000",   "-37760381302507477694015627/238343149396461530948567040000000"},
            new Fraction[]{"938361466493681003887058054117058139/411763970814139367424000000",  "-368494364748615982580024489494053019/169081823764260126720000000",    "65438384060924982511210081634369383937/34323610224144805724160000000", "-10477646881545274376628826839705957371/6864722044828961144832000000", "23814299351456454796742954738962731383/21280638338969779548979200000", "-128040694677155321420532888465716357323/170245106711758236391833600000",  "394799904028690062041830380432515823161/851225533558791181959168000000",   "-31943482184615439776561993749032813631/121603647651255883137024000000",   "23279285142077313974639513061935655149/170245106711758236391833600000",    "-8795719067346824569100578739059266293/134404031614545976098816000000",    "36853026366455805158667637028181037/1280038396329009296179200000", "-9902814561186559573284680138954548043/851225533558791181959168000000",    "31635156443674713410591757494949587/7338151151368889499648000000", "-622109229436345672186540475053108391/425612766779395590979584000000", "27483245101763537444109264709093847/60801823825627941568512000000",    "-10808477273340045195073345879996693/85122553355879118195916800000",   "13720499146083656752322146349686927/425612766779395590979584000000",   "-1269225205654552620484782154577/172662380032209164697600000", "1907518128814061848674544201494523/1276838300338186772938752000000",   "-16296885975014825799241787770409/60801823825627941568512000000",  "1785335697210643958779617383447/42561276677939559097958400000",    "-137149267596644390737921767151/24320729530251176627404800000",    "3802472818996782637735845396533/5958578734911538273714176000000",  "-40511042162404503515031540953999/685236554514826901477130240000000",  "128280790624349275328911836973/29792893674557691368570880000000",  "-1377558295832456341098288793/5958578734911538273714176000000",    "14259923321360680617878509/1752523157326923021680640000000",   "-37760381302507477694015627/268136043071019222317137920000000"},
            new Fraction[]{"0", "1929874424456276893028287124163463433/3690902502024921966182400000",   "-19409123259065984906002280189507676341/21051814270808814177484800000",    "365917127770153690187782109842528035701/326303121197536619751014400000",   "-1397854159324096225891544324095337438287/1253003985398540619843895296000",    "1650353905863998008995397178061650389241/1722880479922993352285356032000", "-181618177472128590255602846663109587851/249692823177245413374689280000",  "1872368230339552491729447229450467733/3783224593594627475374080000",   "-62136744256328772464115821135882801827/204294128054109883670200320000",   "1925703896825051156971442360991877373/11349673780783882426122240000",  "-45729117589677960505068559880526179/530634098841843853688832000", "41187558513878689568742739028620259/1031788525525807493283840000", "-139257144055892038307780429359230733/8254308204206459946270720000",   "8514471903445404626246506206435437/1309577743936601818398720000",  "-77672621281839475516207063042982543/34049021342351647278366720000",   "824956309232556646322504470853147/1134967378078388242612224000",   "-13082532629399219953494367812807371/62423205794311353343672320000",   "1798839173358119871007903140224851/33047579538164834123120640000", "-3304714885981601114787589991483333/261042496958029295800811520000",   "23117081214403754916724947042319/8832264934670164143636480000",    "-22117861032961214728625456554801/46407555014760763697922048000",  "2509932273526316699358499301743/33223590521931001283739648000",    "-51169765630482768183637605341351/4983538578289650192560947200000",    "127058058431155680148843127863/108337795180209786794803200000",    "-11840279659383298241959900979/108124111166047637313945600000",    "2933843126692762344126812267/365459495741241014121136128000",  "-16446786172289720130992447531/37951563019282720697194905600000",  "1539535853010148124878229477/100501361328841278883312435200000",   "-5774872516907818239249057359/21708294047029716238795486003200000"},
            new Fraction[]{"-1853054191420728077584974807939811961/130697551869751119052800000",    "1929874424456276893028287124163463433/141957788539420075622400000",    "-19409123259065984906002280189507676341/1619370328523754936729600000", "365917127770153690187782109842528035701/37650360138177302278963200000",    "-1397854159324096225891544324095337438287/192769843907467787668291584000", "1650353905863998008995397178061650389241/331323169215960260054876160000",  "-181618177472128590255602846663109587851/57621420733210480009543680000",   "1872368230339552491729447229450467733/1018560467506245858754560000",   "-62136744256328772464115821135882801827/62859731708956887283138560000",    "1925703896825051156971442360991877373/3928733231809805455196160000",   "-45729117589677960505068559880526179/204090038016093789880320000", "41187558513878689568742739028620259/436525914645533939466240000",  "-139257144055892038307780429359230733/3809680709633750744432640000",   "8514471903445404626246506206435437/654788871968300909199360000",   "-77672621281839475516207063042982543/18334088415112425457582080000",   "824956309232556646322504470853147/654788871968300909199360000",    "-13082532629399219953494367812807371/38414280488806986673029120000",   "105814069021065874765170772954403/1271060751467878235504640000",   "-3304714885981601114787589991483333/180721728663251050939023360000",   "1216688484968618679827628791701/339702497487314005524480000",  "-22117861032961214728625456554801/35698119242123664383016960000",  "2509932273526316699358499301743/26834438498482731806097408000",    "-51169765630482768183637605341351/4216840335475857855243878400000",    "127058058431155680148843127863/95837280351724042164633600000", "-153923635571982877145478712727/1297489333992571647767347200000",  "2933843126692762344126812267/351403361289654821270323200000",  "-16446786172289720130992447531/37951563019282720697194905600000",  "1539535853010148124878229477/104366798303027481917285990400000",   "-5774872516907818239249057359/23378162819878155949472061849600000"},
            new Fraction[]{"0", "-4072088624772879415136866989623081136163/1360271075959954146852864000000",    "16006114684953956189698056194656587599413/3012028811054184182317056000000",    "-299104924566701826829523172262892776279/45766819541184185106432000000",   "194412797287353487882444678974564873462781/29450948374752023115988992000000",  "-544491504762927709163022429928611555907/94243034799206473971164774400",   "10280458032347394562330386533478542531393/2290629318036268464576921600000",    "-2408256593960142411256001324458257942983/768285609776139733460582400000", "242446176664554561401020433810825395481/122227256100749503050547200000",   "-422292502292698280326306821017877407/369545747848071059865600000",    "167940548952838325702772292082090239/279376585373141721258393600", "-524685351127830322294732877354125241/1814133671254167021158400000",   "329433697912701635822175571897803397/2586820234936497419059200000",    "-16721873110194324520322546772141857003/325939349601998674801459200000",   "109929364670744913870450422461741307/5820345528607119192883200000",    "-5052466810109035972088561400651241/796740632360441205070233600",  "92977743786762349240883483393528207/48017850611008733341286400000",    "-278401879312485336369793851303841001/519722618377976878517452800000", "21862871456437359554333026908044017/163616379859733461755494400000",   "-5051849456808353962456583906830927/169096354304796304972185600000",   "3742107708219866125507733534833433/629714823431061439716419174400",    "-4339086588115842124680413016012127/4164780578247760844685312000000",  "948826038954097600443375706147841/5963208555218384845799424000000",    "-999344245226053298606572336339/47932257294411569823744000000",    "1195977780567206275391591007661/520597572280970105585664000000",   "-55878820905430064215957927691/269877781470454902735608217600",    "13599876713615460232893670288093/927704873804688728153653248000000",   "-245236318797138352360930023871/320688104525077585040769024000000",    "48490869507663228376116874351/1855409747609377456307306496000000", "-393244229417180287642283129/895715050570044289251803136000000"},
            new Fraction[]{"4547785993878291283387677762929617247/52140716460207589294080000",  "-4072088624772879415136866989623081136163/48581109855712648101888000000",  "16006114684953956189698056194656587599413/215144915075298870165504000000", "-299104924566701826829523172262892776279/4903587807984019832832000000",    "194412797287353487882444678974564873462781/4207278339250289016569856000000",   "-544491504762927709163022429928611555907/16829113357001156066279424000",   "10280458032347394562330386533478542531393/490849139579200385266483200000", "-2408256593960142411256001324458257942983/192071402444034933365145600000", "242446176664554561401020433810825395481/34922073171642715157299200000",    "-422292502292698280326306821017877407/118782561808308554956800000",    "167940548952838325702772292082090239/99777351918979186163712000",  "-524685351127830322294732877354125241/712695370849851329740800000",    "329433697912701635822175571897803397/1108637243544213179596800000",    "-16721873110194324520322546772141857003/151328983743785099014963200000",   "109929364670744913870450422461741307/2910172764303559596441600000",    "-5052466810109035972088561400651241/426825338764522074144768000",  "92977743786762349240883483393528207/27438771777719276195020800000",    "-16376581136028549198223167723755353/18561522084927745661337600000",   "21862871456437359554333026908044017/105181958481257225414246400000",   "-265886813516229155918767574043733/6039155510885582320435200000",  "3742107708219866125507733534833433/449796302450758171226013696000",    "-4339086588115842124680413016012127/3123585433685820633513984000000",  "948826038954097600443375706147841/4685378150528730950270976000000",    "-999344245226053298606572336339/39372925634695218069504000000",    "1195977780567206275391591007661/446226490526545804787712000000",   "-55878820905430064215957927691/240962304884334734585364480000",    "13599876713615460232893670288093/861440239961496676142678016000000",   "-245236318797138352360930023871/309234957934896242717884416000000",    "48490869507663228376116874351/1855409747609377456307306496000000", "-393244229417180287642283129/927704873804688728153653248000000"},
            new Fraction[]{"0", "1437502467756711350105001285805996156867/84388738240742229245952000000",   "-1314194367654278333528185167191957257239469/43207033979260021373927424000000",    "40070554082094505218974375692469569269647/1060886995026473739091968000000",    "-72923119554927616704538981656663283991993/1886021324491508869496832000000",   "436908509617497081701713622358320933891/12694374299462078929305600000",    "-66497767552029842647397029118292367133693/2437319865496719154426675200000",   "3121380233830929468994677436577410619/160013121421790910873600000",    "-4418200937749426265141151356203131821/348586937284999879065600000",   "2452219309786861911887990400168734953/326140051171950644428800000",    "-2922902227198444041404951979420253307/715644455143023128346624000",   "51714371682321881362943116780805033/25413510480931219046400000",   "-29135919453049298612771043572915160061/31309444912507261865164800000",    "19596655296940393472219854093431761/50175392487992406835200000",   "-9860469017377901172967221530967001091/65600741721443786765107200000", "11400097487214390380791084225694977/215252433773487425323008000",  "-8438733601132623803903363919799884791/495080597679021078242918400000",    "5195628910754739195032765023036151/1040085289241640920678400000",  "-154114382506176377974063171919150317/116062850737939007353651200000", "4469727013679904295692165538236719/14030624225721245132390400000", "-26585402310179700126561478681877237/387755433147205320022425600000",  "227422264385455763246878138353007/17310510408357380358144000000",  "-399038978405342498617037506126573/179708400389079114448896000000",    "3734189876862210356383108709531/11414901791018272555008000000",    "-15962016372329673088462637035699/385777089100535905124352000000", "93429961043205807333128202889/21217739900529474781839360000",  "-98150792960255105965181289508393/255918585877155511214800896000000",  "151648949259616093818671359649/5775940306255245912834048000000",   "-157429321530076919296080950147/118819343442965058778300416000000",    "2278266364664795504843640739/51983462756297213215506432000000",    "-474373308075249689656066073/665388323280604329158482329600000"},
            new Fraction[]{"-830164709030459353712547549841490458999/1564221493806227678822400000", "1437502467756711350105001285805996156867/2812957941358074308198400000",    "-1314194367654278333528185167191957257239469/2880468931950668091595161600000", "40070554082094505218974375692469569269647/106088699502647373909196800000", "-72923119554927616704538981656663283991993/251469509932201182599577600000",    "436908509617497081701713622358320933891/2115729049910346488217600000", "-66497767552029842647397029118292367133693/487463973099343830885335040000",    "3121380233830929468994677436577410619/37336394998417879203840000", "-4418200937749426265141151356203131821/92956516609333301084160000",    "2452219309786861911887990400168734953/97842015351585193328640000", "-2922902227198444041404951979420253307/238548151714341042782208000",   "51714371682321881362943116780805033/9318287176341446983680000",    "-29135919453049298612771043572915160061/12523777965002904746065920000",    "19596655296940393472219854093431761/21742670078130042961920000",   "-9860469017377901172967221530967001091/30613679470007100490383360000", "11400097487214390380791084225694977/107626216886743712661504000",  "-8438733601132623803903363919799884791/264042985428811241729556480000",    "305625230044396423237221471943303/34669509641388030689280000", "-154114382506176377974063171919150317/69637710442763404412190720000",  "235248790193679173457482396749301/467687474190708171079680000",    "-26585402310179700126561478681877237/258503622098136880014950400000",  "227422264385455763246878138353007/12117357285850166250700800000",  "-399038978405342498617037506126573/131786160285324683929190400000",    "3734189876862210356383108709531/8751424706447342292172800000", "-15962016372329673088462637035699/308621671280428724099481600000", "93429961043205807333128202889/17681449917107895651532800000",  "-98150792960255105965181289508393/221796107760201443052827443200000",  "151648949259616093818671359649/5198346275629721321550643200000",   "-157429321530076919296080950147/110898053880100721526413721600000",    "2278266364664795504843640739/50250680664420639441656217600000",    "-474373308075249689656066073/665388323280604329158482329600000"},
            new Fraction[]{"0", "-311435296432374650825437602735798339746401/3233558671996233857661665280000",  "480376110011937635401660633820901867893143/2778839483746763471427993600000",   "-442606021758048149420549702430378147011809/2044203758158538645648179200000",  "24312567631254202882486181056391643389/108395985479277713817600000",   "-2071693742123884748307679295679345678959509/10221018790792693228240896000000",    "134003867542306515093325606497357656303/818991890287876059955200000",  "-536811165061780294371978676063825620743/4492755512436348671754240000",    "31747880050543938361147782995377759643/399258546515339579228160000",   "-7360822790165704326657200889322929767/151928930372243674890240000",   "3421780283031551579830364405031695813/126247761743980894617600000",    "-2048613304179285051648603999566506379/146906486392995950100480000",   "13895437897369183895895525730483121/2104129362399681576960000",    "-3936162882588832755677114675260843759/1367360373350193074012160000",  "45800258496247736931495369475095797/39677867976679709736960000",   "-289764406724045735501545328141824200563/681401252719512881882726400000",  "14339333147289926209303792589565713/99814636628834894807040000",   "-82119707952253695548338448755904893/1849958152179672982487040000",    "62129568907610473197456383201930039/4968550801079781430394880000", "-185280769091874173599890610912553501/57932900028784496030515200000",  "15885960174330560062963565410323457/21498537120056746573824000000",    "-9494926950090151247640796138562237/61945568429046625625702400000",    "4026679080434919806858374097863/142139088397069398835200000",  "-784131113844647359390950625362709/169676991783910322366054400000",    "1837713393915508594231971218777/2794809825607377054597120000", "-3450137897134259517350801362449929/42928278921329311558611763200000", "85342148880389470547410524001/10319297817627238355435520000",  "-32130229289928325850463249462911/46108151434020371674064486400000",   "32077857797160442157167099289/694709870936690867856998400000", "-96868598416262654853665530489/42928278921329311558611763200000",  "13872895826959846806365771/191833100455890969427968000000",    "-1419562952459689457355770581/1244920088718550035199741132800000"},
            new Fraction[]{"7565456921639780595402406113278811035171/2367718081444973537280000000", "-311435296432374650825437602735798339746401/101048708499882308051927040000",   "480376110011937635401660633820901867893143/173677467734172716964249600000",    "-442606021758048149420549702430378147011809/191644102327362998029516800000",   "24312567631254202882486181056391643389/13549498184909714227200000",    "-2071693742123884748307679295679345678959509/1597034186061358316912640000000", "134003867542306515093325606497357656303/153560979428976761241600000",  "-536811165061780294371978676063825620743/982790268345451271946240000", "31747880050543938361147782995377759643/99814636628834894807040000",    "-7360822790165704326657200889322929767/42730011667193533562880000",    "3421780283031551579830364405031695813/39452425544994029568000000", "-2048613304179285051648603999566506379/50499104697592357847040000",    "13895437897369183895895525730483121/789048510899880591360000", "-3936162882588832755677114675260843759/555490151673515936317440000",   "45800258496247736931495369475095797/17359067239797373009920000",   "-289764406724045735501545328141824200563/319406837212271663382528000000",  "14339333147289926209303792589565713/49907318314417447403520000",   "-4830571056014923267549320515053229/57811192255614780702720000",   "62129568907610473197456383201930039/2794809825607377054597120000", "-9751619425888114399994242679608079/1810403125899515500953600000", "15885960174330560062963565410323457/13436585700035466608640000000",    "-9494926950090151247640796138562237/40651779281561848066867200000",    "4026679080434919806858374097863/97720623272985211699200000",   "-784131113844647359390950625362709/121955337844685544200601600000",    "1837713393915508594231971218777/2096107369205532790947840000", "-3450137897134259517350801362449929/33537717907288524655165440000000", "85342148880389470547410524001/8384429476822131163791360000",   "-32130229289928325850463249462911/38903752772454688599991910400000",   "32077857797160442157167099289/607871137069604509374873600000", "-96868598416262654853665530489/38903752772454688599991910400000",  "13872895826959846806365771/179843531677397783838720000000",    "-1419562952459689457355770581/1206016335946095346599749222400000"},
        };

        static FiniteDifference() {
            table = new MultiPrecision<N>[frac_table.Length][];

            for (int i = 0; i < frac_table.Length; i++) {
                table[i] = new MultiPrecision<N>[frac_table[i].Length];

                for (int j = 0; j < frac_table[i].Length; j++) {
                    Fraction f = frac_table[i][j];

                    table[i][j] = MultiPrecision<N>.Div(f.Numer, f.Denom);
                }

            }

            sample_points = table[^1].Length;
        }

        public static MultiPrecision<N>[] Diff(MultiPrecision<N> x, Func<MultiPrecision<N>, MultiPrecision<N>> f, MultiPrecision<N> h) {
            MultiPrecision<N>[] s = new MultiPrecision<N>[sample_points * 2 + 1];

            MultiPrecision<N>[] ds = new MultiPrecision<N>[table.Length];

            for (int i = -sample_points, j = 0; i <= sample_points; i++, j++) {
                s[j] = f(x + h * i);
            }

            for (int i = 0; i < table.Length; i++) {
                MultiPrecision<DoubleN> d = 0;
                MultiPrecision<N>[] ts = table[i];

                if ((i & 1) == 0) {
                    for (int j = 1; j < ts.Length; j++) {
                        d += (ts[j] * (s[sample_points + j] - s[sample_points - j])).Convert<DoubleN>();
                    }
                }
                else {
                    d += (ts[0] * s[sample_points]).Convert<DoubleN>();
                    for (int j = 1; j < ts.Length; j++) {
                        d += (ts[j] * (s[sample_points + j] + s[sample_points - j])).Convert<DoubleN>();
                    }
                }

                d /= MultiPrecision<DoubleN>.Pow(h.Convert<DoubleN>(), i + 1);

                ds[i] = d.Convert<N>();
            }

            return ds;
        }
    }
}
